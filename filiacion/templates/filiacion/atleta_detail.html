{% extends 'base.html' %}

{% block title %}Detalle del Atleta{% endblock %}

{% block content %}
<div class="bg-white rounded-lg shadow-md p-6">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
        <h2 class="text-3xl font-bold text-slate-800">{{ atleta.nombres }} {{ atleta.apellidos }}</h2>
        <div class="flex gap-2">
            <a href="{% url 'atleta_update' atleta.pk %}"
                class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded transition-colors duration-200">
                Editar
            </a>
            <a href="{% url 'atleta_delete' atleta.pk %}"
                class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded transition-colors duration-200">
                Eliminar
            </a>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {% if atleta.foto_perfil %}
        <div class="col-span-full flex flex-col items-center mb-4">
            <img src="{{ atleta.foto_perfil.url }}" alt="Foto de {{ atleta.nombres }}"
                class="w-28 h-38 object-cover border border-slate-300 rounded shadow-md">
            <p class="text-sm text-slate-500 mt-2">Foto Carnet</p>
        </div>
        {% endif %}
        <p class="text-slate-700"><strong class="font-semibold">Cédula Escolar:</strong> {{ atleta.cedula_escolar|default:"-" }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Fecha de Nacimiento:</strong> {{ atleta.fecha_nacimiento }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Categoría:</strong> {{ atleta.categoria|default:"Sin Asignar" }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Representante:</strong> {{ atleta.representante }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Peso:</strong> {{ atleta.peso_kg|default:"-" }} kg</p>
        <p class="text-slate-700"><strong class="font-semibold">Altura:</strong> {{ atleta.altura_mts|default:"-" }} mts</p>
        <p class="text-slate-700"><strong class="font-semibold">Posición:</strong> {{ atleta.get_posicion_display }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Lateralidad:</strong> {{ atleta.get_lateralidad_display }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Estado:</strong> {{ atleta.activo|yesno:"Activo,Inactivo" }}</p>
        <p class="text-slate-700"><strong class="font-semibold">Becado:</strong> {{ atleta.becado|yesno:"Sí,No" }}</p>
    </div>
</div>

<!-- Sección Evaluaciones -->
<div class="bg-white rounded-lg shadow-md p-6 mt-6">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
        <h3 class="text-2xl font-bold text-slate-800">Evaluaciones</h3>
        <div class="flex gap-2">
            <a href="{% url 'evaluacion_tecnica_create' %}?atleta={{ atleta.pk }}"
                class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded transition-colors duration-200">
                Nueva Evaluación Técnica
            </a>
            <a href="{% url 'evaluacion_psicosocial_create' %}?atleta={{ atleta.pk }}"
                class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded transition-colors duration-200">
                Nueva Evaluación Psicosocial
            </a>
        </div>
    </div>

    <!-- Tabla Evaluaciones Técnicas -->
    <div class="mb-6">
        <h4 class="text-lg font-semibold text-slate-700 mb-3">Evaluaciones Técnicas</h4>
        {% if atleta.evaluaciones_tecnicas.exists %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-slate-200">
                <thead class="bg-slate-50">
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Fecha</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Entrenador</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Velocidad</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Resistencia</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Control</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Pase
                        </th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Tiro
                        </th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Táctica</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Acciones</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-slate-200">
                    {% for eval in atleta.evaluaciones_tecnicas.all|slice:":5" %}
                    <tr class="hover:bg-slate-50">
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.fecha_evaluacion }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.entrenador|default:"-" }}
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.velocidad }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.resistencia }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.control_balon }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.pase_corto }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.tiro }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.inteligencia_tactica }}
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm">
                            <a href="{% url 'evaluacion_tecnica_update' eval.pk %}"
                                class="text-blue-600 hover:text-blue-800 font-medium">Editar</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-slate-500 italic">No hay evaluaciones técnicas registradas.</p>
        {% endif %}
    </div>

    <!-- Tabla Evaluaciones Psicosociales -->
    <div>
        <h4 class="text-lg font-semibold text-slate-700 mb-3">Evaluaciones Psicosociales</h4>
        {% if atleta.evaluaciones_psicosociales.exists %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-slate-200">
                <thead class="bg-slate-50">
                    <tr>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Fecha</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Evaluador</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Compromiso</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Puntualidad</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Compañerismo</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Respeto</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">M.
                            Frustración</th>
                        <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">
                            Acciones</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-slate-200">
                    {% for eval in atleta.evaluaciones_psicosociales.all|slice:":5" %}
                    <tr class="hover:bg-slate-50">
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.fecha_evaluacion }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.coordinador_evaluador|default:"-" }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.compromiso }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.puntualidad }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.companerismo }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.respeto }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-slate-700">{{ eval.manejo_frustracion }}
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm">
                            <a href="{% url 'evaluacion_psicosocial_update' eval.pk %}"
                                class="text-blue-600 hover:text-blue-800 font-medium">Editar</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-slate-500 italic">No hay evaluaciones psicosociales registradas.</p>
        {% endif %}
    </div>
</div>

<div class="mt-6">
    <a href="{% url 'atleta_list' %}"
        class="bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded transition-colors duration-200">
        Volver al listado
    </a>
</div>
{% endblock %}